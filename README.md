
# 旅程表作成アプリの概要

|旅のしおり一覧| 旅程表画面 |
|-------|-------|
| ![旅のしおり一覧](/public/thumbnail/shiori01.jpg) | ![旅程表画面](/public/thumbnail/itinerary_thumbnail_02.jpg) |

「英語が話せない人でも安心して行ける海外旅行へ」をコンセプトに制作している、旅程表アプリとなっています。

私自身が英会話ができないですが、何度も海外旅行をしてきました。

英語が話せない同行する友人とでも楽しめるように、色々と事前に調べごとをしてメモを取っていくなどして、旅を楽しんできました。

その経験を元に、「私自身が使用する為」でもあり、「英語が話せない人でも海外旅行へ行きたい人」の為に制作しています。

Next.jsを利用したフルスタックアプリとして開発している旅程表アプリとなっています。

このリポジトリには以下の2つのアプリが含まれています。

- 旅程表アプリ
- Next.jsのISRブログ

ブログは旅程表アプリのマーケティングとして利用をする為、管理者のみが投稿できる仕様になっています。（ユーザーは作成した旅程表から帰国後にブログを作成できる機能を追加予定）

## 主な機能

旅程表

- ユーザー認証機能
- 旅のしおりのCRUD
  - 旅程表のCRUD 
  - 旅のメモのCRUD
- 作成した旅程表の共有機能
- 旅程に画像の投稿
- 旅程が同じ日付なら1度日付表示し並び変え
- 旅程を時間で並び替え
- フォームバリデーション 
- 各種アニメーション

ブログ

- 管理者のみの認証機能
- バリデーション
- 
- 

## 使用技術

- Next.js 14
- Next.js Server Actions
- node.js
- Tailwind CSS（スタイル）
- NextAuth(認証)
- Supabase (画像のストレージ)
- PostgreSQL(Supabase )(DB)

## アプリのサムネイル画像


|旅のしおり一覧| 旅程表の共有設定 |
|-------|-------|
| ![旅のしおり一覧](/public/thumbnail/shiori01.jpg) | ![旅程表の共有設定](/public/thumbnail/share.jpg) |

|旅程表画面 | メモ表示画面 |
|-------|-------|
| ![旅程表画面](/public/thumbnail/itinerary_thumbnail_02.jpg) | ![メモ表示画面](/public/thumbnail/memo.jpg) |

|初回マニュアル表示 | 日時で並び替え |
|-------|-------|
| ![初回マニュアル表示](/public/thumbnail/manual.jpg) | ![日時で並び替え](/public/thumbnail/auto-date01.jpg) |

|スマホサイズの旅程表/メモ | スマホサイズのフォーム |
|-------|-------|
| ![スマホサイズの旅程表/メモ](/public/thumbnail/sumaho.jpg) | ![スマホサイズのフォーム](/public/thumbnail/sumaho-form.jpg) |

|旅程表作成フォーム | メモ作成フォーム |
|-------|-------|
| ![旅程表作成フォーム](/public/thumbnail/itinerary-create.jpg) | ![メモ作成フォーム](/public/thumbnail/memo-create.jpg) |

|プロフィール変更 | フォームバリデーション |
|-------|-------|
| ![プロフィール変更](/public/thumbnail/profile.jpg) | ![フォームバリデーション](/public/thumbnail/balidate.jpg) |

|トップページ | ブログトップページ |
|-------|-------|
| ![トップページ](/public/thumbnail/itinerary_thumbnail.jpg) | ![ブログトップページ](/public/thumbnail/isr_thumbnail.jpg) |


## セットアップ手順

1. リポジトリをクローン：

```
git clone https://github.com/haru0354/trip-abroad-itinerary.git

cd trip-abroad-itinerary
```

2. 依存関係をインストール：

```
npm install
```

3. 環境ファイルを用意

```
cp .env.sample .env

env ファイルへの記載
```

4. サーバーを起動

```
npm run dev
```

### コマンドの概要

| コマンド      | 説明                                       |
| ------------- | ------------------------------------------ |
| `npm install` | フロントエンドの依存関係をインストール     |
| `npm run dev` | フロント・バックのサーバー起動と監視を開始 |



## hタグの構造

見出しタグは考慮されなくなったとも言われていますが、SEOを意識した適切なサイト構造になるように作られています。

TOPページのみh1タグがサイトタイトル
個別ページ・カテゴリページに関してはカテゴリ名・記事タイトルがh1

記事のコンテンツに関してはタイトルがh1タグとなるので、h2タグより記載をするようになっています。

## 旅程表アプリの特徴

旅程表アプリの主な機能

- 旅程表の作成が可能
- 複数の旅行のしおりが作成可能
- 旅行中に撮影した画像を追加し思い出のしおりとすることが可能
- SNSや旅行の同行者に共有できる機能
- 旅行前の準備/旅行中に使えるメモ(各旅行のしおり事に作成可能)

英語が話せない人でも気軽に海外旅行ができるをコンセプトに作成した旅程表作成アプリです。

私自身が友人や家族と海外旅行をする際に、乗り換え手段・観光地への行き方・海外旅行時の保険の連絡先などなど、
色々とメモを取り旅行に出発をしてきました。

しかし、適当にメモをしたのだと見づらかったり、同行者への共有などが面倒だった経験をしています。
そのため、私自身が海外旅行をする際に使いたいアプリとして作成しました。

## ブログの特徴

管理者のみがブログの投稿をできるようになっています。
.envファイルでパスワードなどの設定が必要です。

- 記事
- カテゴリ
- 画像

以上、3種類の投稿フォームがあります。

カテゴリに関しては記事ページと同じように、SEOを考慮してコンテンツを追加できるようになっています。
そのため、内部ページが集まるカテゴリに関しても、きちんとしたページとして作成が可能です。

関連記事に関しては最下部で表示がされます。

また、コンテンツを記載しない場合に関しては関連記事のみの表示ができるようになっています。
そのため、カテゴリを作りこまない場合や、後程、作成をするつもりだとしても、見栄えやHタグに関してもきちんと考慮がされています。

### ブログのコンテンツにコンポーネントの使用

ブログの記事部分（コンテンツ内）に作成したコンポーネントを使用することが可能です。

セキュリティを考慮して、サニタイズがされるようにしているので、作成したコンポーネントのタグを使用すると、DBへの追加のフォームデータと表示の部分で削除がされます。

そのため、そのタグを使えるように設定を加える必要があります。

下記の3つのファイルにタグの差し替えとサニタイズされないように追記することで、ブログのコンテンツ内でのコンポーネントの使用ができるようになります。

詳細は下記のファイルをご確認ください。

components > CustomComponents.tsx(タグの差し替え)
components > blog > FormPost.tsx(フォームデータのサニタイズ)
components > blog > blogContent > ArticleContentArea.tsx(表示のサニタイズ)

### ブログのコンテンツにNext.jsのLinkコンポーネントの使用

ブログのコンテンツ部分に関しても、内部リンクでNext,jsのLinkコンポーネントも使用できるようにしています。

使用方法：「Link」タグの代わりに「next」タグを使用する。
(通常の「a」タグの使用はブラウザの本来の動作をします)

XSS対策・サニタイズで「DOMPurify」を使用しており、タグが指し変わるようにしています。

ただ、Next.JsのLinkコンポーネントと同様に「Link」タグを使うと上手く差し変わりません。

そのため、「next」タグを変わりに使用しています。

### ブログのセキュリティ対策について

ブログはサニタイズやXSSの防止などの為、「DOMPurify」のライブラリが使用されています。

ブログは環境変数で設定したIDなどを使用して管理者が利用するよう作られており、アカウントの作成などはありません。

ただ、IDやパスワードの漏れなどの可能性もあります。

そのため、ブログもサニタイズが行われるようにしています。

## デザイン

カラーは(tailwind.config.ts)より一括で変更が可能になっています。
その他の全て共通している部分やブログのスタイルはglobal.cssを使用。
それ以外に関してはtailwindでそのままスタイルの適用をしています。

### アプリのCSS詳細

h2に関しては共通して同じデザインがほとんどなのでglobal.cssで記載しています。
その他のhタグに関しては使う場所によって違うのでtailwindの使用をしています。

### ブログ用のCSS詳細

h2に関しては共通して同じデザインがほとんどなのでglobal.cssを使用。
その他のhタグに関しては使う場所によって違うのでtailwindの使用をしています。

ブログのコンテンツエリアに関しては.blogで管理。
そのため、記事やカテゴリの投稿時には、見出しタグなどを記載すれば、デザインが適用されるようになっています。

## 今後追加/変更する項目

- サイトマップの追加(実装済み)
- blogの目次の自動生成(実装済み)
- ブログのコンテンツにNext.JsのLinkコンポーネントを使用できるようにする(実装済み)
- ブログのコンテンツに作成したデザインコンポーネントが利用できるようにする(実装済み)

- shareのユーザーページを作成する。
- shareの一覧ページを作成する。
- formの制御をReact-Hook-Formに変更して記述を少なくする。
- 旅程表のデータを使いユーザーがブログを投稿できるようにする。
- 共有された旅程表にコメントを出来るようにする。
- ブログ・旅程表にタグを登録してクリックで適用する。
- 画像ライブラリから記事・カテゴリの部分でアップロードせずとも選択ができるようにする。
　(自分が使う分には必要ないので行わないかも)
